import{r as s,j as e}from"./index-DXtarUcJ.js";import{v as I,G as W,g as H,P as L}from"./pdf-vendor-B1Z1FYJ2.js";import"./react-vendor-DS08_OVb.js";const J=()=>{const[t,P]=s.useState(null),[d,F]=s.useState(!1),[m,n]=s.useState(0),[T,g]=s.useState(0),[y,j]=s.useState(0),[C,a]=s.useState(""),k=s.useRef(null);s.useEffect(()=>{W.workerSrc=`https://unpkg.com/pdfjs-dist@${I}/build/pdf.worker.min.mjs`},[]);const _=s.useCallback(r=>{var i;const l=(i=r.target.files)==null?void 0:i[0];if(l){if(l.type!=="application/pdf"){a("请选择PDF文件");return}P(l),a(""),n(0),g(0),j(0)}},[]),E=s.useCallback(async()=>{if(t){F(!0),a(""),n(0),g(0);try{const r=await t.arrayBuffer(),l=await H({data:r}).promise,i=l.numPages;j(i);const c=new L;c.layout="LAYOUT_16x9",c.author="FreeTool PDF to PPT Converter",c.title=t.name.replace(".pdf","");for(let o=1;o<=i;o++){g(o);const D=await l.getPage(o),x=D.getViewport({scale:2}),p=document.createElement("canvas"),S=p.getContext("2d");if(!S)throw new Error("无法创建canvas上下文");p.width=x.width,p.height=x.height,await D.render({canvasContext:S,viewport:x}).promise;const $=p.toDataURL("image/png"),A=c.addSlide(),h=10,f=5.625,N=x.width/x.height,B=h/f;let u,b,v,w;N>B?(u=h,b=h/N,v=0,w=(f-b)/2):(b=f,u=f*N,v=(h-u)/2,w=0),A.addImage({data:$,x:v,y:w,w:u,h:b});const G=Math.round(o/i*100);n(G)}const M=t.name.replace(".pdf",".pptx");await c.writeFile({fileName:M}),n(100),a("")}catch(r){console.error("转换失败:",r),a(`转换失败: ${r instanceof Error?r.message:"未知错误"}`)}finally{F(!1)}}},[t]),R=s.useCallback(()=>{P(null),a(""),n(0),g(0),j(0),k.current&&(k.current.value="")},[]);return e.jsxs("div",{className:"flex w-full flex-col items-center px-4 py-10 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex w-full max-w-4xl flex-col items-center gap-2 text-center mb-8",children:[e.jsx("p",{className:"text-3xl font-black leading-tight tracking-tighter text-gray-900 dark:text-white sm:text-4xl",children:"PDF 转 PPT"}),e.jsx("p",{className:"text-base font-normal text-gray-500 dark:text-gray-400",children:"将PDF文件转换为PowerPoint演示文稿"})]}),e.jsxs("div",{className:"w-full max-w-4xl flex flex-col gap-6",children:[e.jsx("div",{className:"rounded-xl border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-800/20 shadow-sm p-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"选择PDF文件"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{ref:k,type:"file",accept:".pdf,application/pdf",onChange:_,className:"flex-1 text-sm text-gray-600 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:opacity-90"}),t&&!d&&e.jsx("button",{onClick:R,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700",children:"清除"})]})]}),t&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-blue-600 dark:text-blue-400 text-3xl",children:"picture_as_pdf"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(t.size/1024/1024).toFixed(2)," MB",y>0&&` · ${y} 页`]})]})]})}),C&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-red-600 dark:text-red-400",children:"error"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:C})]})}),t&&!d&&m<100&&e.jsxs("button",{onClick:E,disabled:d,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-primary text-white border border-gray-300 dark:border-gray-600 rounded-lg font-semibold shadow hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed transition-opacity",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"transform"}),e.jsx("span",{children:"开始转换"})]}),d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["正在转换第 ",T," / ",y," 页..."]}),e.jsxs("span",{children:[m,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${m}%`}})})]}),m===100&&!d&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-green-600 dark:text-green-400",children:"check_circle"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"转换完成！PPT文件已自动下载"})]})})]})}),e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-800/20 shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"功能说明"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary mt-0.5",children:"check_circle"}),e.jsx("p",{children:"纯前端转换，无需上传到服务器，数据安全"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary mt-0.5",children:"check_circle"}),e.jsx("p",{children:"每个PDF页面将转换为一张高清图片并插入PPT"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary mt-0.5",children:"check_circle"}),e.jsx("p",{children:"自动适应16:9宽屏比例，保持原始页面宽高比"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary mt-0.5",children:"check_circle"}),e.jsx("p",{children:"支持任意页数的PDF文件转换"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-yellow-500 mt-0.5",children:"info"}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500",children:[e.jsx("strong",{children:"注意："}),"转换后的PPT中每页都是图片，不包含可编辑的文本"]})]})]})]}),!t&&e.jsx("div",{className:"rounded-xl border border-dashed border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/30 p-8",children:e.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-gray-400 dark:text-gray-500",children:"upload_file"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:"上传您的PDF文件开始转换"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"支持任意大小的PDF文件，转换在浏览器本地完成"})]})]})})]})]})};export{J as default};
