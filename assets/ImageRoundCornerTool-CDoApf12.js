import{r as l,j as e}from"./index-B3CJtaT8.js";import"./react-vendor-DS08_OVb.js";import"./pdf-vendor-B1Z1FYJ2.js";const E=()=>{const[m,p]=l.useState(null),[n,b]=l.useState(""),[c,y]=l.useState(20),[j,h]=l.useState(!1),[w,i]=l.useState(null),[u,v]=l.useState({width:0,height:0}),k=l.useRef(null),R=l.useCallback(t=>{var x;const s=(x=t.target.files)==null?void 0:x[0];if(!s)return;if(!s.type.startsWith("image/")){i("请选择图片文件");return}p(s),i(null);const a=new FileReader;a.onload=r=>{var o;const d=(o=r.target)==null?void 0:o.result;b(d)},a.readAsDataURL(s)},[]);l.useEffect(()=>{const t=s=>{var x;const a=(x=s.clipboardData)==null?void 0:x.items;if(a){for(let r=0;r<a.length;r++)if(a[r].type.startsWith("image/")){const d=a[r].getAsFile();if(d){p(d),i(null);const o=new FileReader;o.onload=g=>{var N;const f=(N=g.target)==null?void 0:N.result;b(f)},o.readAsDataURL(d)}break}}};return document.addEventListener("paste",t),()=>document.removeEventListener("paste",t)},[]),l.useEffect(()=>{if(!n)return;const t=new Image;t.onload=()=>{v({width:t.width,height:t.height})},t.src=n},[n]);const C=l.useCallback(()=>{if(!n||!m)return;h(!0),i(null);const t=new Image;t.onload=()=>{const s=k.current;if(!s){i("Canvas 创建失败"),h(!1);return}s.width=t.width,s.height=t.height;const a=s.getContext("2d");if(!a){i("Canvas 上下文创建失败"),h(!1);return}a.clearRect(0,0,s.width,s.height);const x=Math.min(t.width,t.height)/2,r=c/100*x;a.beginPath(),a.moveTo(r,0),a.lineTo(t.width-r,0),a.quadraticCurveTo(t.width,0,t.width,r),a.lineTo(t.width,t.height-r),a.quadraticCurveTo(t.width,t.height,t.width-r,t.height),a.lineTo(r,t.height),a.quadraticCurveTo(0,t.height,0,t.height-r),a.lineTo(0,r),a.quadraticCurveTo(0,0,r,0),a.closePath(),a.clip(),a.drawImage(t,0,0),s.toBlob(d=>{if(!d){i("图片处理失败"),h(!1);return}const o=URL.createObjectURL(d),g=document.createElement("a");g.href=o;const f=m.name.replace(/\.[^/.]+$/,"");g.download=`${f}_rounded.png`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(o),h(!1)},"image/png")},t.onerror=()=>{i("图片加载失败"),h(!1)},t.src=n},[n,m,c]),P=Math.min(u.width,u.height)/2,S=Math.round(c/100*P),F=c/2;return e.jsxs("div",{className:"flex w-full flex-col items-center px-4 py-10 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex w-full max-w-6xl flex-col items-center gap-2 text-center mb-8",children:[e.jsx("p",{className:"text-3xl font-black leading-tight tracking-tighter text-gray-900 dark:text-white sm:text-4xl",children:"图片圆角处理"}),e.jsx("p",{className:"text-base font-normal text-gray-500 dark:text-gray-400",children:"快速为您的图片添加圆角效果，支持自定义圆角大小"})]}),e.jsx("canvas",{ref:k,className:"hidden"}),e.jsxs("div",{className:"w-full max-w-6xl flex flex-col gap-10",children:[w&&e.jsx("div",{className:"bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:w})}),e.jsx("div",{className:"w-full rounded-xl border border-gray-200 dark:border-gray-800 bg-white dark:bg-background-dark shadow-sm",children:n?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"relative flex flex-col p-6 border-b lg:border-b-0 lg:border-r border-gray-200 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-gray-900 dark:text-white text-base font-semibold leading-normal flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"image"}),"原始图片"]}),e.jsx("button",{onClick:()=>{p(null),b(""),v({width:0,height:0})},className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"更换图片"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700 p-4 min-h-[300px]",children:e.jsx("img",{src:n,alt:"Original",className:"max-w-full max-h-[400px] object-contain"})}),m&&e.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 text-center",children:[m.name," (",u.width," x ",u.height,")"]})]}),e.jsxs("div",{className:"relative flex flex-col p-6 bg-gray-50/50 dark:bg-gray-800/30 gap-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h3",{className:"text-gray-900 dark:text-white text-base font-semibold leading-normal flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"rounded_corner"}),"圆角预览"]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center rounded-lg border border-gray-200 dark:border-gray-700 p-4 min-h-[300px]",style:{backgroundImage:"linear-gradient(45deg, #e0e0e0 25%, transparent 25%), linear-gradient(-45deg, #e0e0e0 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #e0e0e0 75%), linear-gradient(-45deg, transparent 75%, #e0e0e0 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",backgroundColor:"#f5f5f5"},children:e.jsx("img",{src:n,alt:"Rounded Preview",className:"max-w-full max-h-[400px] object-contain transition-[border-radius] duration-100",style:{borderRadius:`${F}%`}})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"圆角大小"}),e.jsxs("span",{className:"text-sm font-medium text-primary",children:[c,"% ",u.width>0&&`(${S}px)`]})]}),e.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:c,onChange:t=>y(parseInt(t.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 px-1",children:[e.jsx("span",{children:"无圆角"}),e.jsx("span",{children:"正圆"})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{label:"无",value:0},{label:"小",value:10},{label:"中",value:25},{label:"大",value:50},{label:"正圆",value:100}].map(t=>e.jsx("button",{onClick:()=>y(t.value),className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${c===t.value?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:t.label},t.value))}),e.jsx("button",{onClick:C,disabled:!n||j,style:{backgroundColor:"#607AFB"},className:"flex h-11 w-full cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg px-6 text-sm font-bold text-white shadow-lg transition-opacity hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-50",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner",style:{width:"16px",height:"16px",borderWidth:"2px"}}),e.jsx("span",{className:"truncate",children:"处理中..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined",children:"download"}),e.jsx("span",{className:"truncate",children:"下载圆角图片 (PNG)"})]})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"导出为 PNG 格式以保留透明背景"})]})]}):e.jsxs("label",{className:"flex flex-col items-center gap-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-700 p-8 sm:p-14 text-center cursor-pointer hover:border-primary dark:hover:border-primary transition-colors m-6",children:[e.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 dark:text-gray-500",children:"rounded_corner"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"拖拽图片至此或粘贴图片"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"支持 JPG, PNG, BMP, GIF 等格式"})]}),e.jsx("span",{className:"flex h-10 min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-gray-100 dark:bg-white/10 px-4 text-sm font-bold text-gray-800 dark:text-white transition-colors hover:bg-gray-200 dark:hover:bg-white/20",children:"点击选择文件"}),e.jsx("input",{type:"file",accept:"image/*",onChange:R,className:"hidden"})]})})]})]})};export{E as default};
