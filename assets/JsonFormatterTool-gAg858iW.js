import{r as s,j as e}from"./index-C-8bSDCG.js";import"./react-vendor-DS08_OVb.js";import"./pdf-vendor-B1Z1FYJ2.js";const $=()=>{const[i,k]=s.useState(""),[l,x]=s.useState(null),[w,y]=s.useState(!1),[S,u]=s.useState(!1),[p,m]=s.useState(null),[b,O]=s.useState(2),[j,g]=s.useState(new Set),c=s.useRef(null),N=s.useCallback(t=>{if(!t.trim()){x(null),m(null);return}try{const r=JSON.parse(t);x(r),m(null),g(new Set(["root"]))}catch(r){m(r instanceof Error?r.message:"JSON 格式错误"),x(null)}},[]);s.useEffect(()=>(c.current&&clearTimeout(c.current),i.trim()?c.current=setTimeout(()=>{N(i)},300):(x(null),m(null)),()=>{c.current&&clearTimeout(c.current)}),[i,N]);const v=s.useCallback(()=>{if(!l)return;const t=JSON.stringify(l,null,b);navigator.clipboard.writeText(t).then(()=>{y(!0),u(!1),setTimeout(()=>{u(!0)},1700),setTimeout(()=>{y(!1),u(!1)},2e3)}).catch(r=>{console.error("Failed to copy text: ",r)})},[l,b]),h=s.useCallback(t=>{g(r=>{const a=new Set(r);return a.has(t)?a.delete(t):a.add(t),a})},[]),C=s.useCallback(()=>{if(!l)return;const t=new Set,r=(a,o)=>{t.add(o),a&&typeof a=="object"&&Object.keys(a).forEach(n=>{r(a[n],`${o}.${n}`)})};r(l,"root"),g(t)},[l]),J=s.useCallback(()=>{g(new Set(["root"]))},[]),f=s.useCallback((t,r,a=0)=>{const o=j.has(r);if(t===null)return e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"null"});if(typeof t=="boolean")return e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:t.toString()});if(typeof t=="number")return e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:t});if(typeof t=="string")return e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:['"',t,'"']});if(Array.isArray(t))return t.length===0?e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"[]"}):e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>h(r),className:"inline-flex items-center gap-1 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:o?"expand_more":"chevron_right"}),e.jsxs("span",{children:["[",t.length,"]"]})]}),o&&e.jsx("div",{className:"ml-4 border-l border-gray-300 dark:border-gray-600 pl-2",children:t.map((n,d)=>e.jsxs("div",{className:"py-0.5",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:[d,":"]}),f(n,`${r}[${d}]`,a+1)]},d))})]});if(typeof t=="object"){const n=Object.keys(t);return n.length===0?e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"{}"}):e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>h(r),className:"inline-flex items-center gap-1 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:o?"expand_more":"chevron_right"}),e.jsxs("span",{children:["{",n.length,"}"]})]}),o&&e.jsx("div",{className:"ml-4 border-l border-gray-300 dark:border-gray-600 pl-2",children:n.map(d=>e.jsxs("div",{className:"py-0.5",children:[e.jsxs("span",{className:"text-orange-600 dark:text-orange-400 mr-2",children:['"',d,'":']}),f(t[d],`${r}.${d}`,a+1)]},d))})]})}return e.jsx("span",{children:String(t)})},[j,b,h]);return e.jsxs("div",{className:"flex w-full flex-col items-center px-4 py-10 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex w-full max-w-6xl flex-col items-center gap-2 text-center mb-8",children:[e.jsx("p",{className:"text-3xl font-black leading-tight tracking-tighter text-gray-900 dark:text-white sm:text-4xl",children:"JSON 格式化工具"}),e.jsx("p",{className:"text-base font-normal text-gray-500 dark:text-gray-400",children:"粘贴 JSON 数据,自动格式化并以树形结构展示。"})]}),w&&e.jsx("div",{className:`fixed top-8 left-1/2 -translate-x-1/2 z-50 ${S?"animate-fade-out-up":"animate-fade-in-down"}`,children:e.jsxs("div",{className:"bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"check_circle"}),e.jsx("span",{className:"font-medium",children:"已复制到剪贴板!"})]})}),e.jsx("div",{className:"w-full max-w-6xl rounded-xl border border-gray-200 dark:border-gray-700/50 bg-white dark:bg-gray-800/20 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"relative flex flex-col p-4 border-b lg:border-b-0 lg:border-r border-gray-200 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 min-h-[36px]",children:[e.jsxs("h3",{className:"text-gray-900 dark:text-white text-base font-semibold leading-normal flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"data_object"}),"原始 JSON"]}),e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:[i.length," 字符"]})]}),e.jsx("textarea",{value:i,onChange:t=>k(t.target.value),className:"flex-1 resize-none rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 text-gray-900 dark:text-gray-100 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary min-h-[400px] placeholder:text-gray-400 dark:placeholder:text-gray-500 p-4 text-sm leading-relaxed font-mono",placeholder:"在此处粘贴 JSON 数据..."})]}),e.jsxs("div",{className:"relative flex flex-col p-4 bg-gray-50/50 dark:bg-gray-800/30",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3 min-h-[36px] gap-2",children:[e.jsxs("h3",{className:"text-gray-900 dark:text-white text-base font-semibold leading-normal flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"account_tree"}),"树形视图"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:C,disabled:!l,className:"flex items-center gap-1 px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded text-xs font-medium hover:bg-blue-200 dark:hover:bg-blue-900/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_more"}),"展开"]}),e.jsxs("button",{onClick:J,disabled:!l,className:"flex items-center gap-1 px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400 rounded text-xs font-medium hover:bg-orange-200 dark:hover:bg-orange-900/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_less"}),"收起"]}),e.jsxs("button",{onClick:v,disabled:!l,className:"flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary rounded text-xs font-medium hover:bg-primary/20 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"content_copy"}),"复制"]})]})]}),p&&e.jsxs("div",{className:"mb-2 p-2 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded text-xs text-red-600 dark:text-red-400",children:[e.jsx("span",{className:"material-symbols-outlined text-sm align-middle mr-1",children:"error"}),p]}),e.jsx("div",{className:"relative bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 min-h-[400px] p-4 text-sm overflow-auto",children:l?e.jsx("div",{className:"font-mono text-xs",children:f(l,"root")}):p?null:e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 dark:text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-5xl mb-2 block opacity-50",children:"account_tree"}),e.jsx("p",{className:"text-sm",children:"格式化后的 JSON 将显示在此处"})]})})})]})]})})]})};export{$ as default};
