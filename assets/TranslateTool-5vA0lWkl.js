import{r as o,j as e}from"./index-BYGa83ML.js";import"./react-vendor-DS08_OVb.js";import"./pdf-vendor-1qLBXhNR.js";const T={zh:"中文","zh-CN":"中文","zh-TW":"繁体中文",en:"英语",ja:"日语",ko:"韩语",fr:"法语",de:"德语",es:"西班牙语",ru:"俄语",ar:"阿拉伯语",pt:"葡萄牙语",it:"意大利语",auto:"自动检测"};function R(a){const d=(a.match(/[\u4e00-\u9fa5]/g)||[]).length,r=a.replace(/\s/g,"").length;return d/r>.3}async function U(a,d){try{const r=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${d}&dt=t&q=${encodeURIComponent(a)}`,s=`https://api.allorigins.win/raw?url=${encodeURIComponent(r)}`,c=await fetch(s);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const n=await c.json();if(!n||!n[0]||!n[0][0])throw new Error("Invalid response format");const m=n[0].map(i=>i[0]).join(""),l=n[2]||"auto";return{translatedText:m,detectedLang:T[l]||l}}catch(r){throw console.error("Google Translate error:",r),r}}async function F(a,d,r){try{const s=`https://api.mymemory.translated.net/get?q=${encodeURIComponent(a)}&langpair=${d}|${r}`,n=await(await fetch(s)).json();if(n.responseStatus===200&&n.responseData)return n.responseData.translatedText;throw new Error("MyMemory translation failed")}catch(s){throw console.error("MyMemory translation error:",s),s}}async function W(a,d="auto",r="auto"){if(!a.trim())throw new Error("请输入需要翻译的文本");let s=d,c=r;(d==="auto"||r==="auto")&&(R(a)?(s="zh",c=r==="auto"?"en":r):(s="en",c=r==="auto"?"zh":r));let n="",m=T[s]||s;try{const l=await U(a,c);n=l.translatedText,m=l.detectedLang}catch(l){console.error("Google Translate failed, trying MyMemory:",l);try{n=await F(a,s,c)}catch(i){throw console.error("All translation methods failed:",i),new Error("翻译服务暂时不可用,请检查网络连接或稍后重试")}}return{translatedText:n,detectedLang:m,sourceLangCode:s,targetLangCode:c}}const y=[{code:"auto",name:"自动检测"},{code:"zh",name:"中文"},{code:"en",name:"英语"},{code:"ja",name:"日语"},{code:"ko",name:"韩语"},{code:"fr",name:"法语"},{code:"de",name:"德语"},{code:"es",name:"西班牙语"}],q=y.filter(a=>a.code!=="auto"),B=()=>{const[a,d]=o.useState(""),[r,s]=o.useState(""),[c,n]=o.useState(!1),[m,l]=o.useState(null),[i,S]=o.useState("auto"),[u,E]=o.useState("zh"),[k,p]=o.useState(""),[N,b]=o.useState(!1),[v,w]=o.useState(!1),[L,C]=o.useState(!1),[z,j]=o.useState(!1),f=o.useRef(null),x=o.useCallback(async(t,h,I)=>{if(!t.trim()){s(""),p("");return}n(!0),l(null);try{const g=await W(t,h,I);s(g.translatedText),p(g.detectedLang)}catch(g){console.error(g),l(g instanceof Error?g.message:"翻译失败,请稍后重试。"),s("")}finally{n(!1)}},[]);o.useEffect(()=>(f.current&&clearTimeout(f.current),a.trim()?f.current=setTimeout(()=>{x(a,i,u)},500):(s(""),p(""),l(null)),()=>{f.current&&clearTimeout(f.current)}),[a,i,u,x]);const M=o.useCallback(()=>{r&&navigator.clipboard.writeText(r).then(()=>{C(!0),j(!1),setTimeout(()=>{j(!0)},1700),setTimeout(()=>{C(!1),j(!1)},2e3)}).catch(t=>{console.error("Failed to copy text: ",t),l("复制文本失败。")})},[r]),$=o.useCallback(()=>{d(""),s(""),p(""),l(null)},[]),A=o.useCallback(t=>{S(t),b(!1),a.trim()&&x(a,t,u)},[a,u,x]),D=o.useCallback(t=>{E(t),w(!1),a.trim()&&x(a,i,t)},[a,i,x]),G=()=>{var t;return k&&i==="auto"?k:((t=y.find(h=>h.code===i))==null?void 0:t.name)||"自动检测"},_=()=>{var t;return((t=y.find(h=>h.code===u))==null?void 0:t.name)||"中文"};return e.jsxs("div",{className:"flex w-full flex-col items-center px-4 py-10 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex w-full max-w-5xl flex-col items-center gap-2 text-center mb-8",children:[e.jsx("p",{className:"text-3xl font-black leading-tight tracking-tighter text-gray-900 dark:text-white sm:text-4xl",children:"在线翻译"}),e.jsx("p",{className:"text-base font-normal text-gray-500 dark:text-gray-400",children:"在不同语言之间即时翻译文本。"})]}),m&&e.jsx("div",{className:"w-full max-w-5xl mb-4",children:e.jsx("p",{className:"text-red-500 bg-red-100 dark:bg-red-900/50 p-3 rounded-lg",children:m})}),L&&e.jsx("div",{className:`fixed top-8 left-1/2 -translate-x-1/2 z-50 ${z?"animate-fade-out-up":"animate-fade-in-down"}`,children:e.jsxs("div",{className:"bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"check_circle"}),e.jsx("span",{className:"font-medium",children:"已复制到剪贴板!"})]})}),e.jsxs("div",{className:"w-full max-w-5xl rounded-xl border border-gray-200 dark:border-gray-700/50 bg-white dark:bg-gray-800/20 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 border-b border-gray-200 dark:border-gray-700/50 p-3",children:[e.jsxs("div",{className:"w-full sm:w-auto sm:min-w-[200px] relative",children:[e.jsxs("button",{onClick:()=>{b(!N),w(!1)},className:"w-full flex items-center justify-between px-4 py-2.5 rounded-lg text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700/50 focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("span",{children:G()}),e.jsx("span",{className:"material-symbols-outlined text-base",children:"expand_more"})]}),N&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-10 max-h-60 overflow-y-auto",children:y.map(t=>e.jsx("button",{onClick:()=>A(t.code),className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 ${i===t.code?"bg-primary/10 text-primary":"text-gray-700 dark:text-gray-300"}`,children:t.name},t.code))})]}),e.jsx("span",{className:"material-symbols-outlined text-2xl text-gray-400 dark:text-gray-500 hidden sm:block",children:"arrow_forward"}),e.jsxs("div",{className:"w-full sm:w-auto sm:min-w-[200px] relative",children:[e.jsxs("button",{onClick:()=>{w(!v),b(!1)},className:"w-full flex items-center justify-between px-4 py-2.5 rounded-lg text-sm font-medium text-primary bg-primary/10 dark:bg-primary/20 focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("span",{children:_()}),e.jsx("span",{className:"material-symbols-outlined text-base",children:"expand_more"})]}),v&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-10 max-h-60 overflow-y-auto",children:q.map(t=>e.jsx("button",{onClick:()=>D(t.code),className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 ${u===t.code?"bg-primary/10 text-primary":"text-gray-700 dark:text-gray-300"}`,children:t.name},t.code))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[e.jsxs("div",{className:"relative flex flex-col p-4",children:[e.jsx("textarea",{value:a,onChange:t=>d(t.target.value),className:"flex-1 resize-none border-0 bg-transparent p-2 text-base font-normal text-gray-800 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-0",placeholder:"输入文本...",rows:8}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:[a.length," / 5000",c&&e.jsx("span",{className:"ml-2",children:"翻译中..."})]}),e.jsx("button",{onClick:$,disabled:!a,className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700/50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("span",{className:"material-symbols-outlined text-base",children:"close"})})]})]}),e.jsxs("div",{className:"relative flex flex-col border-t md:border-t-0 md:border-l border-gray-200 dark:border-gray-700/50 p-4 bg-gray-50/50 dark:bg-gray-800/30",children:[e.jsx("div",{className:"flex-1 p-2 text-base font-normal text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:r||e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"翻译结果将显示在此处。"})}),e.jsx("div",{className:"flex items-center justify-end pt-2",children:e.jsx("button",{onClick:M,disabled:!r,className:"p-2 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700/50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("span",{className:"material-symbols-outlined text-base",children:"content_copy"})})})]})]})]})]})};export{B as default};
